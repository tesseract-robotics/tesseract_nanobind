name: tesseract_nb
channels:
  - conda-forge
  - defaults

dependencies:
  # Python version set by CI matrix or user; default to 3.12 if not specified
  # - python=3.12  # Uncomment for local dev, CI uses python-version param

  # Build tools
  - cmake>=3.15,<4
  - ninja
  - make
  - pkg-config

  # C++ dependencies - pinned for C++17 compatibility and API stability
  - eigen>=3.3,<3.5
  - boost-cpp>=1.70,<2
  - console_bridge>=1.0,<2
  - assimp>=5.0,<6
  - urdfdom>=3.0,<5
  - octomap>=1.9,<2
  - orocos-kdl>=1.4,<2
  - flann>=1.9,<2
  - jsoncpp>=1.9,<2
  - yaml-cpp>=0.6,<1
  - tinyxml2>=10,<11  # pin to 10.x (SO version 10) for consistent wheel bundling
  - bullet-cpp>=3.21,<4
  - fcl>=0.7,<1
  - ompl>=1.5,<2
  - pcl>=1.12,<2
  - ipopt>=3.14,<4
  - gtest>=1.10,<2
  - qpoases>=3.2,<4
  - taskflow>=3.6,<3.8  # 3.8+ requires C++20, we use C++17
  - llvm-openmp>=14,<20  # OpenMP runtime (use conda's, not Homebrew's, to avoid duplicate lib crashes)
  # Note: libosqp/osqp-eigen removed - trajopt needs OSQP 0.6.x, conda has 1.0.x
  # trajopt_ext/osqp builds compatible version automatically

  # Python build dependencies (conda-only)
  - pip
  - pytest-benchmark
  - setuptools>=68
  - wheel
  - scikit-build-core>=0.10,<1
  - nanobind>=1.3.2,<3
  - patchelf

  # Python dependencies (via pip from requirements.txt for consistency)
  - pip:
    - -r requirements.txt

# Notes:
# - Some packages require brew on macOS: swig, automake, autoconf, libtool
# - Install with: brew install swig automake autoconf libtool
#
# Usage:
#   conda env create -f environment.yml
#   conda activate tesseract_nb
#
# Or use mamba for faster installation:
#   mamba env create -f environment.yml
